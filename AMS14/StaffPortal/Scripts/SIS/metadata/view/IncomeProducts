{
    "type": "Ext.panel.Panel",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "border": false,
        "container|align": "stretch",
        "designer|userAlias": "incomeproducts",
        "designer|userClassName": "IncomeProducts",
        "height": 465,
        "keyMapConfig": [
            "{\r",
            "    bindings: [\r",
            "        {\r",
            "            ctrl: false,\r",
            "            key: Ext.EventObject.ENTER,\r",
            "            btnItemId: 'btnSave'\r",
            "        }\r",
            "    ]\r",
            "}"
        ],
        "layout": "vbox",
        "title": "",
        "width": 970
    },
    "configAlternates": {
        "keyMapConfig": "object"
    },
    "designerId": "6170bf67-6dab-4228-a5ae-e84587948bc3",
    "customConfigs": [
        {
            "group": "(Custom Properties)",
            "name": "keyMapConfig",
            "type": "string"
        }
    ],
    "cn": [
        {
            "type": "Ext.container.Container",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "container|align": "stretch",
                "layout": "vbox",
                "layout|flex": null,
                "margin": "5 10 0 10"
            },
            "designerId": "08f0a5b7-0514-47d3-8b21-469568e19f97",
            "cn": [
                {
                    "type": "Ext.form.FieldSet",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "collapsible": true,
                        "container|align": "stretch",
                        "layout": "vbox",
                        "layout|flex": null,
                        "margin": "0 0 0 0",
                        "title": "მომწოდებელი"
                    },
                    "designerId": "9e05ad55-baa8-481b-81e3-d5d63a07802e",
                    "cn": [
                        {
                            "type": "Ext.container.Container",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "container|align": "stretch",
                                "layout": "vbox",
                                "layout|flex": null
                            },
                            "designerId": "ea2ebb80-f22d-469e-9015-8098c4b4e707",
                            "cn": [
                                {
                                    "type": "Ext.form.field.ComboBox",
                                    "reference": {
                                        "name": "items",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "allowBlank": false,
                                        "displayField": "Name",
                                        "emptyText": null,
                                        "fieldLabel": "მომწოდებელი",
                                        "itemId": "cmbDistributors",
                                        "layout|flex": 1,
                                        "margin": "0 0 10 0",
                                        "minChars": 1,
                                        "selectOnFocus": true,
                                        "store": "ActiveDistributorStore",
                                        "storeClassName": "SIS.store.ActiveDistributorStore",
                                        "triggerCls": "x-form-search-trigger",
                                        "typeAhead": true,
                                        "valueField": "ID"
                                    },
                                    "designerId": "b7c2f3be-208b-4bb2-a612-9f94c58cb556",
                                    "customConfigs": [
                                        {
                                            "group": "(Custom Properties)",
                                            "name": "storeClassName",
                                            "type": "string"
                                        }
                                    ],
                                    "cn": [
                                        {
                                            "type": "basiceventbinding",
                                            "reference": {
                                                "name": "listeners",
                                                "type": "array"
                                            },
                                            "codeClass": null,
                                            "userConfig": {
                                                "fn": "onCmbDistributorsSelect",
                                                "implHandler": [
                                                    "var form = this;\r",
                                                    "\r",
                                                    "var txtCode = FindControl(form, 'txtCode');\r",
                                                    "var txtAddress = FindControl(form, 'txtAddress');\r",
                                                    "\r",
                                                    "var fsProducts = FindControl(form, 'fsProducts');\r",
                                                    "\r",
                                                    "var record = combo.getSelectedRecord();\r",
                                                    "\r",
                                                    "if(!IsNullOrEmpty(record))\r",
                                                    "{\r",
                                                    "    txtCode.setDisabled(false);\r",
                                                    "    txtAddress.setDisabled(false);\r",
                                                    "\r",
                                                    "    txtCode.setValue(record.get('Code'));\r",
                                                    "    txtAddress.setValue(record.get('Address'));\r",
                                                    "\r",
                                                    "    var txtAmount = FindControl(form, 'txtAmount');\r",
                                                    "    var txtInputPrice = FindControl(form, 'txtInputPrice');\r",
                                                    "    var txtOutputPrice = FindControl(form, 'txtOutputPrice');\r",
                                                    "    var txtTotalPrice = FindControl(form, 'txtTotalPrice');\r",
                                                    "\r",
                                                    "    txtAmount.regex = new RegExp('^[+-]?[0-9]+?$');\r",
                                                    "    txtInputPrice.regex = new RegExp('^[+-]?[0-9]+(.[0-9]+)?$');\r",
                                                    "    txtOutputPrice.regex = new RegExp('^[+-]?[0-9]+(.[0-9]+)?$');\r",
                                                    "    txtTotalPrice.regex = new RegExp('^[+-]?[0-9]+(.[0-9]+)?$');\r",
                                                    "\r",
                                                    "    fsProducts.setVisible(true);\r",
                                                    "}"
                                                ],
                                                "name": "select",
                                                "scope": "me"
                                            },
                                            "designerId": "409a7577-9e1c-4d69-ae84-bb9ac2822f96"
                                        }
                                    ]
                                },
                                {
                                    "type": "Ext.form.field.Text",
                                    "reference": {
                                        "name": "items",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "allowBlank": false,
                                        "disabled": true,
                                        "emptyText": null,
                                        "fieldLabel": "კოდი",
                                        "itemId": "txtCode",
                                        "labelWidth": null,
                                        "layout|flex": 1,
                                        "margin": "0 0 0 0",
                                        "readOnly": true,
                                        "selectOnFocus": true
                                    },
                                    "designerId": "95e69244-e8cd-4788-8c5c-13b489379268"
                                },
                                {
                                    "type": "Ext.form.field.Text",
                                    "reference": {
                                        "name": "items",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "allowBlank": false,
                                        "disabled": true,
                                        "emptyText": null,
                                        "fieldLabel": "მისამართი",
                                        "itemId": "txtAddress",
                                        "labelWidth": null,
                                        "layout|flex": 1,
                                        "margin": "10 0 10 0",
                                        "readOnly": true,
                                        "selectOnFocus": true
                                    },
                                    "designerId": "3c36ac9c-131d-44ff-afd3-0f8077291d00"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "Ext.form.FieldSet",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "collapsible": true,
                        "container|align": "stretch",
                        "disabled": null,
                        "hidden": true,
                        "itemId": "fsProducts",
                        "layout": "hbox",
                        "layout|flex": 1,
                        "margin": "0 0 0 0",
                        "title": "საქონელი"
                    },
                    "designerId": "7c8b2404-f3d9-4a3d-9817-30b4100dfb29",
                    "cn": [
                        {
                            "type": "Ext.container.Container",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "container|align": "stretch",
                                "layout": "hbox",
                                "layout|flex": 1,
                                "margin": "-5 0 5 0"
                            },
                            "designerId": "fa39b2a4-1fde-4e0c-bd28-40fda6cdcb9e",
                            "cn": [
                                {
                                    "type": "Ext.container.Container",
                                    "reference": {
                                        "name": "items",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "container|align": "stretch",
                                        "layout": "vbox",
                                        "layout|flex": 1,
                                        "margin": "0 10 0 0"
                                    },
                                    "designerId": "689165db-5a5f-41af-9d8a-b9207e9244f1",
                                    "cn": [
                                        {
                                            "type": "Ext.form.field.ComboBox",
                                            "reference": {
                                                "name": "items",
                                                "type": "array"
                                            },
                                            "codeClass": null,
                                            "userConfig": {
                                                "allowBlank": false,
                                                "displayField": "Name",
                                                "emptyText": null,
                                                "fieldLabel": "დასახელება",
                                                "itemId": "cmbProducts",
                                                "layout|flex": null,
                                                "margin": "5 0 5 0",
                                                "minChars": 1,
                                                "selectOnFocus": true,
                                                "store": "ActiveProductStore",
                                                "storeClassName": "SIS.store.ActiveProductStore",
                                                "tpl": "<tpl for=\".\"><div class=\"x-boundlist-item\" >{Name} <span style=\"color: red\"><b>{CurrentAmount}</b></span> <b>{SizeUnitName} <b><span style=\"color: green\">{InputPrice}</span> ლარი</b></b></div></tpl>",
                                                "triggerCls": "x-form-search-trigger",
                                                "typeAhead": true,
                                                "valueField": "ID"
                                            },
                                            "designerId": "fc9e41a9-01d0-4617-9152-642356153bb0",
                                            "customConfigs": [
                                                {
                                                    "group": "(Custom Properties)",
                                                    "name": "storeClassName",
                                                    "type": "string"
                                                },
                                                {
                                                    "group": "(Custom Properties)",
                                                    "name": "tpl",
                                                    "type": "string"
                                                }
                                            ],
                                            "cn": [
                                                {
                                                    "type": "basiceventbinding",
                                                    "reference": {
                                                        "name": "listeners",
                                                        "type": "array"
                                                    },
                                                    "codeClass": null,
                                                    "userConfig": {
                                                        "fn": "onCmbProductsSelect",
                                                        "implHandler": [
                                                            "var form = this;\r",
                                                            "\r",
                                                            "var txtSizeUnit = FindControl(form, 'txtSizeUnit');\r",
                                                            "\r",
                                                            "var record = combo.getSelectedRecord();\r",
                                                            "\r",
                                                            "if(!IsNullOrEmpty(record))\r",
                                                            "{\r",
                                                            "    var txtAmount = FindControl(form, 'txtAmount');\r",
                                                            "    var txtInputPrice = FindControl(form, 'txtInputPrice');\r",
                                                            "    var txtOutputPrice = FindControl(form, 'txtOutputPrice');\r",
                                                            "    var txtTotalPrice = FindControl(form, 'txtTotalPrice');\r",
                                                            "\r",
                                                            "    txtSizeUnit.setDisabled(false);\r",
                                                            "    txtAmount.setDisabled(false);\r",
                                                            "    txtInputPrice.setDisabled(false);\r",
                                                            "    txtOutputPrice.setDisabled(false);\r",
                                                            "    txtTotalPrice.setDisabled(false);\r",
                                                            "\r",
                                                            "    txtSizeUnit.setValue(record.get('SizeUnitName'));\r",
                                                            "}"
                                                        ],
                                                        "name": "select",
                                                        "scope": "me"
                                                    },
                                                    "designerId": "bb75fa46-50ef-46bd-b0e2-571ca06b3cd9"
                                                }
                                            ]
                                        },
                                        {
                                            "type": "Ext.form.field.Text",
                                            "reference": {
                                                "name": "items",
                                                "type": "array"
                                            },
                                            "codeClass": null,
                                            "userConfig": {
                                                "allowBlank": false,
                                                "disabled": true,
                                                "emptyText": null,
                                                "fieldLabel": "ერთეული",
                                                "itemId": "txtSizeUnit",
                                                "labelWidth": null,
                                                "layout|flex": null,
                                                "margin": "5 0 5 0",
                                                "readOnly": true,
                                                "selectOnFocus": true
                                            },
                                            "designerId": "d494ef4b-6977-43e3-b212-b02ae74fd202"
                                        },
                                        {
                                            "type": "Ext.form.field.Text",
                                            "reference": {
                                                "name": "items",
                                                "type": "array"
                                            },
                                            "codeClass": null,
                                            "userConfig": {
                                                "allowBlank": false,
                                                "disabled": true,
                                                "emptyText": null,
                                                "fieldLabel": "რაოდენობა",
                                                "inputType": null,
                                                "itemId": "txtAmount",
                                                "labelWidth": null,
                                                "layout|flex": null,
                                                "margin": "5 0 5 0",
                                                "selectOnFocus": true,
                                                "vtype": null
                                            },
                                            "designerId": "b6bee6da-4e60-4267-8eb0-95547dd6fd7b",
                                            "cn": [
                                                {
                                                    "type": "basiceventbinding",
                                                    "reference": {
                                                        "name": "listeners",
                                                        "type": "array"
                                                    },
                                                    "codeClass": null,
                                                    "userConfig": {
                                                        "fn": "onTxtAmountChange",
                                                        "implHandler": [
                                                            "var form = this;\r",
                                                            "\r",
                                                            "var txtTotalPrice = FindControl(form, 'txtTotalPrice');\r",
                                                            "var txtInputPrice = FindControl(form, 'txtInputPrice');\r",
                                                            "\r",
                                                            "if(txtInputPrice.getValue() !== null){\r",
                                                            "    var val = txtInputPrice.getValue() * field.getValue();\r",
                                                            "\r",
                                                            "    txtTotalPrice.setValue(val);\r",
                                                            "}"
                                                        ],
                                                        "name": "change",
                                                        "scope": "me"
                                                    },
                                                    "designerId": "7d036cfd-46a3-4fb7-9aff-c9fc790a5216"
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "Ext.container.Container",
                                    "reference": {
                                        "name": "items",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "container|align": "stretch",
                                        "layout": "vbox",
                                        "layout|flex": 1
                                    },
                                    "designerId": "61783eaa-c20e-4920-a755-5c51913bd0c6",
                                    "cn": [
                                        {
                                            "type": "Ext.form.field.Text",
                                            "reference": {
                                                "name": "items",
                                                "type": "array"
                                            },
                                            "codeClass": null,
                                            "userConfig": {
                                                "allowBlank": false,
                                                "disabled": true,
                                                "emptyText": null,
                                                "fieldLabel": "მიღების ფასი",
                                                "inputType": null,
                                                "itemId": "txtInputPrice",
                                                "labelWidth": null,
                                                "layout|flex": null,
                                                "margin": "5 0 5 0",
                                                "selectOnFocus": true,
                                                "vtype": null
                                            },
                                            "designerId": "b26b73ba-db11-46f1-960b-db3ad1d26d5d",
                                            "cn": [
                                                {
                                                    "type": "basiceventbinding",
                                                    "reference": {
                                                        "name": "listeners",
                                                        "type": "array"
                                                    },
                                                    "codeClass": null,
                                                    "userConfig": {
                                                        "fn": "onTxtInputPriceChange",
                                                        "implHandler": [
                                                            "var form = this;\r",
                                                            "\r",
                                                            "var txtTotalPrice = FindControl(form, 'txtTotalPrice');\r",
                                                            "var txtAmount = FindControl(form, 'txtAmount');\r",
                                                            "\r",
                                                            "var str = field.getValue().replace(',', '.');\r",
                                                            "field.setValue(str);\r",
                                                            "\r",
                                                            "if(txtAmount.getValue() !== null){\r",
                                                            "    var val = txtAmount.getValue() * field.getValue();\r",
                                                            "\r",
                                                            "    txtTotalPrice.setValue(val);\r",
                                                            "}"
                                                        ],
                                                        "name": "change",
                                                        "scope": "me"
                                                    },
                                                    "designerId": "71a31f79-e848-4c06-aa8e-d25b73a77e6a"
                                                }
                                            ]
                                        },
                                        {
                                            "type": "Ext.form.field.Text",
                                            "reference": {
                                                "name": "items",
                                                "type": "array"
                                            },
                                            "codeClass": null,
                                            "userConfig": {
                                                "allowBlank": false,
                                                "disabled": true,
                                                "emptyText": null,
                                                "fieldLabel": "რეალიზ. ფასი",
                                                "inputType": null,
                                                "itemId": "txtOutputPrice",
                                                "labelWidth": null,
                                                "layout|flex": null,
                                                "margin": "5 0 5 0",
                                                "selectOnFocus": true,
                                                "vtype": null
                                            },
                                            "designerId": "8121d926-f541-4d7a-853a-93bafacfae45",
                                            "cn": [
                                                {
                                                    "type": "basiceventbinding",
                                                    "reference": {
                                                        "name": "listeners",
                                                        "type": "array"
                                                    },
                                                    "codeClass": null,
                                                    "userConfig": {
                                                        "fn": "onTxtOutputPriceChange",
                                                        "implHandler": [
                                                            "var str = field.getValue().replace(',', '.');\r",
                                                            "field.setValue(str);"
                                                        ],
                                                        "name": "change",
                                                        "scope": "me"
                                                    },
                                                    "designerId": "df943dfd-5dab-4383-b521-22d62d66223e"
                                                }
                                            ]
                                        },
                                        {
                                            "type": "Ext.form.field.Text",
                                            "reference": {
                                                "name": "items",
                                                "type": "array"
                                            },
                                            "codeClass": null,
                                            "userConfig": {
                                                "allowBlank": false,
                                                "disabled": true,
                                                "emptyText": null,
                                                "fieldLabel": "ღირებულება",
                                                "inputType": null,
                                                "itemId": "txtTotalPrice",
                                                "labelWidth": null,
                                                "layout|flex": null,
                                                "margin": "5 0 5 0",
                                                "readOnly": true,
                                                "selectOnFocus": true,
                                                "vtype": null
                                            },
                                            "designerId": "d10b5489-bd17-4c37-8b0d-04e3e0a1ec3f"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "Ext.container.Container",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "container|align": "stretch",
                                "layout": "vbox",
                                "layout|flex": null
                            },
                            "designerId": "891256f9-18af-45c9-b2d5-8369895c6a06",
                            "cn": [
                                {
                                    "type": "Ext.container.Container",
                                    "reference": {
                                        "name": "items",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "layout|flex": 1
                                    },
                                    "designerId": "1e57c443-009b-445a-88dc-4c6e6d035590"
                                },
                                {
                                    "type": "Ext.container.Container",
                                    "reference": {
                                        "name": "items",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "layout|flex": 1
                                    },
                                    "designerId": "661186a7-47b0-4fce-bb63-1722a261485d",
                                    "cn": [
                                        {
                                            "type": "Ext.button.Button",
                                            "reference": {
                                                "name": "items",
                                                "type": "array"
                                            },
                                            "codeClass": null,
                                            "userConfig": {
                                                "iconCls": "icon-save24",
                                                "itemId": "btnSave",
                                                "margin": "12 0 10 10",
                                                "scale": "medium",
                                                "text": "",
                                                "tooltip": [
                                                    "შენახვა"
                                                ]
                                            },
                                            "designerId": "5aac14d3-73e2-48aa-b9f9-ddca1aba242c",
                                            "cn": [
                                                {
                                                    "type": "basiceventbinding",
                                                    "reference": {
                                                        "name": "listeners",
                                                        "type": "array"
                                                    },
                                                    "codeClass": null,
                                                    "userConfig": {
                                                        "fn": "onBtnSaveClick",
                                                        "implHandler": [
                                                            "var form = this;\r",
                                                            "\r",
                                                            "var cmbDistributors = FindControl(form, 'cmbDistributors');\r",
                                                            "var cmbProducts = FindControl(form, 'cmbProducts');\r",
                                                            "var txtAmount = FindControl(form, 'txtAmount');\r",
                                                            "var txtInputPrice = FindControl(form, 'txtInputPrice');\r",
                                                            "var txtOutputPrice = FindControl(form, 'txtOutputPrice');\r",
                                                            "var txtSizeUnit = FindControl(form, 'txtSizeUnit');\r",
                                                            "var txtTotalPrice = FindControl(form, 'txtTotalPrice');\r",
                                                            "\r",
                                                            "if(form.validate()){\r",
                                                            "    var operationModel = Ext.create('SIS.model.OperationModel');\r",
                                                            "    operationModel.set('IO', 'miReba');\r",
                                                            "    operationModel.set('DistributorID', cmbDistributors.getValue());\r",
                                                            "\r",
                                                            "    var data = ModelToJson(operationModel);\r",
                                                            "    Request(\r",
                                                            "        '/Home/SaveOperation',\r",
                                                            "        data,\r",
                                                            "        function(response){\r",
                                                            "            var responseOperationModel = CreateModel(response, 'SIS.model.OperationModel');\r",
                                                            "\r",
                                                            "            var detailModel = Ext.create('SIS.model.DetailModel');\r",
                                                            "            detailModel.set('OperationID', responseOperationModel.get('ID'));\r",
                                                            "            detailModel.set('ProductID', cmbProducts.getValue());\r",
                                                            "            detailModel.set('InputAmount', txtAmount.getValue());\r",
                                                            "            detailModel.set('InputPrice', txtInputPrice.getValue());\r",
                                                            "            detailModel.set('OutputPrice', txtOutputPrice.getValue());\r",
                                                            "            detailModel.set('SizeUnitID', cmbProducts.getSelectedRecord().get('SizeUnitID'));\r",
                                                            "\r",
                                                            "            var data1 = ModelToJson(detailModel);\r",
                                                            "\r",
                                                            "            Request(\r",
                                                            "                '/Home/SaveDetail',\r",
                                                            "                data1,\r",
                                                            "                function(response1){\r",
                                                            "                    var productModel = cmbProducts.getSelectedRecord();\r",
                                                            "\r",
                                                            "                    productModel.set('CurrentAmount', txtAmount.getValue());\r",
                                                            "                    productModel.set('TotalPrice', txtAmount.getValue() * txtOutputPrice.getValue());\r",
                                                            "                    productModel.set('RealPrice', txtAmount.getValue() * txtInputPrice.getValue());\r",
                                                            "                    productModel.set('ToChange', true);\r",
                                                            "                    productModel.set('InputPrice', txtInputPrice.getValue());\r",
                                                            "                    productModel.set('OutputPrice', txtOutputPrice.getValue());\r",
                                                            "\r",
                                                            "                    var data2 = ModelToJson(productModel);\r",
                                                            "                    Request(\r",
                                                            "                        '/Home/SaveProduct',\r",
                                                            "                        data2,\r",
                                                            "                        function(response2){\r",
                                                            "                            form.getRecord(responseOperationModel.get('ID'));\r",
                                                            "                            form.resetForm();\r",
                                                            "                            cmbProducts.getStore().load();\r",
                                                            "                        }\r",
                                                            "                    );\r",
                                                            "                }\r",
                                                            "            );\r",
                                                            "        }\r",
                                                            "    );\r",
                                                            "}"
                                                        ],
                                                        "name": "click",
                                                        "scope": "me"
                                                    },
                                                    "designerId": "70412417-feae-482b-bd19-c4d554e11e04"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "Ext.grid.Panel",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "itemId": "grdIncomeProducts",
                "layout|flex": 1,
                "margin": "10 10 0 10",
                "store": "IncomeProductArrayStore",
                "storeClassName": "SIS.store.IncomeProductArrayStore",
                "title": ""
            },
            "designerId": "382f8db5-41bf-4f88-a9bf-ca532176b7bb",
            "customConfigs": [
                {
                    "group": "(Custom Properties)",
                    "name": "storeClassName",
                    "type": "string"
                }
            ],
            "cn": [
                {
                    "type": "Ext.grid.column.Column",
                    "reference": {
                        "name": "columns",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "dataIndex": "Name",
                        "flex": 1,
                        "text": "დასახელება"
                    },
                    "designerId": "9758d77a-c027-41c6-99a6-9fa0b694d5cc"
                },
                {
                    "type": "Ext.grid.column.Column",
                    "reference": {
                        "name": "columns",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "dataIndex": "Amount",
                        "flex": 1,
                        "text": "რაოდენობა"
                    },
                    "designerId": "f5c1e0cd-0612-4fb5-a74e-b803d1603ed2"
                },
                {
                    "type": "Ext.grid.column.Column",
                    "reference": {
                        "name": "columns",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "dataIndex": "SizeUnitName",
                        "flex": 1,
                        "text": "ერთეული"
                    },
                    "designerId": "868bcea0-d9b6-45d7-89a2-cbb1dbf202d0"
                },
                {
                    "type": "Ext.grid.column.Column",
                    "reference": {
                        "name": "columns",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "dataIndex": "InputPrice",
                        "flex": 1,
                        "text": "მიღების ფასი"
                    },
                    "designerId": "febd7674-9205-4db8-a8f7-4bc197a54850",
                    "cn": [
                        {
                            "type": "fixedfunction",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "designer|params": [
                                    "value",
                                    "metaData",
                                    "record",
                                    "rowIndex",
                                    "colIndex",
                                    "store",
                                    "view"
                                ],
                                "fn": "renderer",
                                "implHandler": [
                                    "return record.get('InputPrice') + ' ლარი';"
                                ]
                            },
                            "designerId": "ad920caf-623f-4717-860f-908cf5879720"
                        }
                    ]
                },
                {
                    "type": "Ext.grid.column.Column",
                    "reference": {
                        "name": "columns",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "dataIndex": "OutputPrice",
                        "flex": 1,
                        "text": "რეალიზ. ფასი"
                    },
                    "designerId": "1aac82ef-092e-4a8f-b147-549ba1272fbf",
                    "cn": [
                        {
                            "type": "fixedfunction",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "designer|params": [
                                    "value",
                                    "metaData",
                                    "record",
                                    "rowIndex",
                                    "colIndex",
                                    "store",
                                    "view"
                                ],
                                "fn": "renderer",
                                "implHandler": [
                                    "return record.get('OutputPrice') + ' ლარი';"
                                ]
                            },
                            "designerId": "890f4f79-5883-4348-9403-a8480db38d9e"
                        }
                    ]
                },
                {
                    "type": "Ext.grid.column.Column",
                    "reference": {
                        "name": "columns",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "dataIndex": "TotalPrice",
                        "flex": 1,
                        "text": "ღირებულება"
                    },
                    "designerId": "0965b968-32da-4c4e-b7c6-c943714de078",
                    "cn": [
                        {
                            "type": "fixedfunction",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "designer|params": [
                                    "value",
                                    "metaData",
                                    "record",
                                    "rowIndex",
                                    "colIndex",
                                    "store",
                                    "view"
                                ],
                                "fn": "renderer",
                                "implHandler": [
                                    "return record.get('TotalPrice') + ' ლარი';"
                                ]
                            },
                            "designerId": "4ab23fee-5083-4f61-8efb-ee5f275c0405"
                        }
                    ]
                },
                {
                    "type": "Ext.grid.View",
                    "reference": {
                        "name": "viewConfig",
                        "type": "object"
                    },
                    "codeClass": null,
                    "designerId": "9459a393-ad3b-44e3-9b4b-7c6687c919ab",
                    "cn": [
                        {
                            "type": "fixedfunction",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "designer|params": [
                                    "record",
                                    "rowIndex",
                                    "rowParams",
                                    "store"
                                ],
                                "fn": "getRowClass",
                                "implHandler": [
                                    "return 'normal-row';"
                                ]
                            },
                            "designerId": "bc521894-d5f0-454a-9ecf-fb420c82bbd2"
                        }
                    ]
                },
                {
                    "type": "Ext.grid.column.Action",
                    "reference": {
                        "name": "columns",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "width": 24
                    },
                    "designerId": "a34574b8-da2c-4c56-8474-78061d9cddee",
                    "cn": [
                        {
                            "type": "actioncolumnitem",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "iconCls": "icon-delete",
                                "tooltip": "წაშლა"
                            },
                            "designerId": "c248492e-647f-434c-abd8-8e02e7aac8f1",
                            "cn": [
                                {
                                    "type": "fixedfunction",
                                    "reference": {
                                        "name": "items",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "designer|params": [
                                            "view",
                                            "rowIndex",
                                            "colIndex",
                                            "item",
                                            "e",
                                            "record",
                                            "row"
                                        ],
                                        "fn": "handler",
                                        "implHandler": [
                                            "var grdIncomeProducts = this.up('grid');\r",
                                            "\r",
                                            "var form = grdIncomeProducts.up('incomeproducts');\r",
                                            "var cmbProducts = FindControl(form, 'cmbProducts');\r",
                                            "var txtAmount = FindControl(form, 'txtAmount');\r",
                                            "var txtTotalPrice = FindControl(form, 'txtTotalPrice');\r",
                                            "\r",
                                            "var detailModel = Ext.create('SIS.model.DetailModel');\r",
                                            "SetDelete(detailModel);\r",
                                            "detailModel.set('OperationID', record.get('OperationID'));\r",
                                            "\r",
                                            "var data = ModelToJson(detailModel);\r",
                                            "\r",
                                            "Request(\r",
                                            "    '/Home/SaveDetail',\r",
                                            "    data,\r",
                                            "    function(response){\r",
                                            "        var productID = record.get('ProductID');\r",
                                            "        Request(\r",
                                            "            '/Home/GetProductByID',\r",
                                            "            {productID: productID},\r",
                                            "            function(response1){\r",
                                            "                var productModel = CreateModel(response1, 'SIS.model.ProductModel');\r",
                                            "\r",
                                            "                productModel.set('CurrentAmount', record.get('Amount'));\r",
                                            "                productModel.set('TotalPrice', record.get('Amount') * record.get('OutputPrice'));\r",
                                            "                productModel.set('RealPrice', record.get('Amount') * record.get('InputPrice'));\r",
                                            "                productModel.set('ToChangeDown', true);\r",
                                            "\r",
                                            "                var data2 = ModelToJson(productModel);\r",
                                            "                Request(\r",
                                            "                    '/Home/SaveProduct',\r",
                                            "                    data2,\r",
                                            "                    function(response2){\r",
                                            "                        grdIncomeProducts.getStore().remove(record);\r",
                                            "                        cmbProducts.getStore().load();\r",
                                            "\r",
                                            "                        var txtTotalPriceSum = FindControl(form, 'txtTotalPriceSum');\r",
                                            "\r",
                                            "                        var totalPriceSum = grdIncomeProducts.getStore().sum('TotalPrice');\r",
                                            "\r",
                                            "                        txtTotalPriceSum.setValue('ჯამი: ' + totalPriceSum + ' ლარი');\r",
                                            "                    }\r",
                                            "                );\r",
                                            "            }\r",
                                            "        );\r",
                                            "    }\r",
                                            ");"
                                        ]
                                    },
                                    "designerId": "4557e332-399e-476a-8b89-387b017d9e6c"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "Ext.container.Container",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "container|align": "stretch",
                "layout": "hbox",
                "layout|flex": null,
                "margin": "10 10 10 10"
            },
            "designerId": "233cbf4e-b57e-4f2f-bd62-262734686469",
            "cn": [
                {
                    "type": "Ext.container.Container",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "height": 32,
                        "layout|flex": null
                    },
                    "designerId": "80d79733-60be-4bab-b221-4de14c1e83e9"
                },
                {
                    "type": "Ext.container.Container",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "layout|flex": 1
                    },
                    "designerId": "a69be225-cc3c-4eaf-a2e8-a00e1f0a71ea"
                },
                {
                    "type": "Ext.container.Container",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "layout|flex": 1
                    },
                    "designerId": "6ec7dbb7-e42a-4d72-9f2f-a815b4fcad57"
                },
                {
                    "type": "Ext.container.Container",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "layout|flex": 1
                    },
                    "designerId": "466ba2c2-f87f-4b4b-a77a-f07118e4a25f"
                },
                {
                    "type": "Ext.container.Container",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "layout|flex": 1
                    },
                    "designerId": "e444b29e-c45e-408e-9af6-a1c156949ea7"
                },
                {
                    "type": "Ext.container.Container",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "layout|flex": 1
                    },
                    "designerId": "ffecd352-260a-4389-b710-7c0f062c8b62"
                },
                {
                    "type": "Ext.form.field.Text",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "emptyText": "ჯამი:",
                        "fieldLabel": "",
                        "fieldStyle": "font-weight: bold; color: red; border: 1px solid gray;",
                        "itemId": "txtTotalPriceSum",
                        "layout|flex": 0.95,
                        "margin": null,
                        "readOnly": true
                    },
                    "designerId": "688e5fde-b1db-4bb6-92d0-d469ad01f152"
                }
            ]
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|params": [
                    "operationID"
                ],
                "fn": "getRecord",
                "implHandler": [
                    "var form = this;\r",
                    "\r",
                    "var cmbProducts = FindControl(form, 'cmbProducts');\r",
                    "var txtSizeUnit = FindControl(form, 'txtSizeUnit');\r",
                    "var txtAmount = FindControl(form, 'txtAmount');\r",
                    "var txtInputPrice = FindControl(form, 'txtInputPrice');\r",
                    "var txtOutputPrice = FindControl(form, 'txtOutputPrice');\r",
                    "var txtTotalPrice = FindControl(form, 'txtTotalPrice');\r",
                    "\r",
                    "var grdIncomeProducts = FindControl(form, 'grdIncomeProducts');\r",
                    "\r",
                    "var model = Ext.create('SIS.model.IncomeProductModel');\r",
                    "\r",
                    "model.set('Name', cmbProducts.getSelectedRecord().get('Name'));\r",
                    "model.set('Amount', txtAmount.getValue());\r",
                    "model.set('SizeUnitName', cmbProducts.getSelectedRecord().get('SizeUnitName'));\r",
                    "model.set('InputPrice', txtInputPrice.getValue());\r",
                    "model.set('OutputPrice', txtOutputPrice.getValue());\r",
                    "model.set('TotalPrice', txtTotalPrice.getValue());\r",
                    "model.set('OperationID', operationID);\r",
                    "model.set('ProductID', cmbProducts.getValue());\r",
                    "\r",
                    "grdIncomeProducts.getStore().add(model);\r",
                    "\r",
                    "var txtTotalPriceSum = FindControl(form, 'txtTotalPriceSum');\r",
                    "\r",
                    "var totalPriceSum = grdIncomeProducts.getStore().sum('TotalPrice');\r",
                    "\r",
                    "txtTotalPriceSum.setValue('ჯამი: ' + totalPriceSum + ' ლარი');"
                ]
            },
            "designerId": "91996cdc-36d4-4743-b0ec-58304bfd3e85"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "resetForm",
                "implHandler": [
                    "var form = this;\r",
                    "\r",
                    "var cmbProducts = FindControl(form, 'cmbProducts');\r",
                    "var txtSizeUnit = FindControl(form, 'txtSizeUnit');\r",
                    "var txtAmount = FindControl(form, 'txtAmount');\r",
                    "var txtInputPrice = FindControl(form, 'txtInputPrice');\r",
                    "var txtOutputPrice = FindControl(form, 'txtOutputPrice');\r",
                    "var txtTotalPrice = FindControl(form, 'txtTotalPrice');\r",
                    "\r",
                    "cmbProducts.reset();\r",
                    "txtSizeUnit.reset();\r",
                    "txtAmount.reset();\r",
                    "txtInputPrice.reset();\r",
                    "txtOutputPrice.reset();\r",
                    "txtTotalPrice.reset();"
                ]
            },
            "designerId": "6bd565d6-5624-42c8-a44d-aef781235569"
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "validate",
                "implHandler": [
                    "var form = this;\r",
                    "\r",
                    "var cmbDistributors = FindControl(form, 'cmbDistributors');\r",
                    "var txtCode = FindControl(form, 'txtCode');\r",
                    "var txtAddress = FindControl(form, 'txtAddress');\r",
                    "\r",
                    "var cmbProducts = FindControl(form, 'cmbProducts');\r",
                    "var txtSizeUnit = FindControl(form, 'txtSizeUnit');\r",
                    "var txtAmount = FindControl(form, 'txtAmount');\r",
                    "var txtInputPrice = FindControl(form, 'txtInputPrice');\r",
                    "var txtOutputPrice = FindControl(form, 'txtOutputPrice');\r",
                    "var txtTotalPrice = FindControl(form, 'txtTotalPrice');\r",
                    "\r",
                    "var valid = true;\r",
                    "\r",
                    "valid = valid && cmbDistributors.validate();\r",
                    "valid = valid && txtCode.validate();\r",
                    "valid = valid && txtAddress.validate();\r",
                    "valid = valid && cmbProducts.validate();\r",
                    "valid = valid && txtSizeUnit.validate();\r",
                    "valid = valid && txtAmount.validate();\r",
                    "valid = valid && txtInputPrice.validate();\r",
                    "valid = valid && txtOutputPrice.validate();\r",
                    "valid = valid && txtTotalPrice.validate();\r",
                    "\r",
                    "if(valid){\r",
                    "    if(txtInputPrice.getValue() >= txtOutputPrice.getValue()){\r",
                    "        valid = false;\r",
                    "        MessageBox('', 'მიღების ფასი ნაკლები უნდა იყოს რეალიზაციის ფასზე!');\r",
                    "    }else{\r",
                    "        valid = true;\r",
                    "    }\r",
                    "}\r",
                    "\r",
                    "return valid;"
                ]
            },
            "designerId": "9fe05c91-6c28-42ac-b262-379e8e6ce963"
        }
    ]
}